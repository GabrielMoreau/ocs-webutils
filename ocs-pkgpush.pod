=head1 NAME

ocs-pkgpush - Push a package to OCS Inventory

=head1 SYNOPSIS

 ocs-pkgpush [--help|-h]
    --url URL [--username USERNAME] [--password PASSWORD] \
    --name NAME --description DESCRIPTION --priority PRIORITY --file FILE [--timeout TIMEOUT] \
    [--notify YES] [--notif-text NOTIF_TEXT] [--notif-duration NOTIF_DURATION] [--can-cancel NO] [--can-report YES] \
    [--headless] [--capture-dir CAPTURE_DIR]

=head1 DESCRIPTION

B<ocs-pkgpush> is a Python-based command line tool to upload and configure packages in OCS Inventory.  
It can reuse an existing login session or prompt for credentials if needed.  
The tool also supports automated form filling and file uploading via Playwright.

=head1 OPTIONS

=over 4

=item B<--url> I<URL>

OCS Inventory URL (e.g. https://server/ocsreports). (Required)

=item B<--username> I<USER>

OCS username (optional if a valid session already exists).

=item B<--password> I<PASS>

OCS password (optional if a valid session already exists).

=item B<--name> I<NAME>

Package name. (Required)

=item B<--description> I<TEXT>

Package description. (Required)

=item B<--priority> I<PRI>

Package priority (value from the OCS Inventory <select> list). (Required)

=item B<--file> I<PATH>

Path to the file to upload. (Required)

=item B<--timeout> I<SECONDS>

Maximal time for uploading package before timeout from the client side.
Default is 300 (5 min).

=item B<--notify> I<{YES,NO}>

Notify user or not.
Default is YES.

=item B<--notif-text> I<TEXT>

Notification text shown to the end user.
This option does not make sense if the C<--notify> option is not enabled.

=item B<--notif-duration> I<SECONDS>

Notification duration.
This option does not make sense if the C<--notify> option is not enabled.

=item B<--can-cancel> I<{YES,NO}>

The user can cancel the package deployment.
Default is NO.
This option does not make sense if the C<--notify> option is not enabled.

=item B<--can-report> I<{YES,NO}>

The user can request that the package deployment be postponed until the next agent launch (approximately one hour later).
Default is YES.
This option does not make sense if the C<--notify> option is not enabled.

=item B<--headless>

Run without showing the browser GUI.

=item B<--capture-dir> I<DIR>

If specified, enables screenshots and saves them in the given directory.

=back

=head1 EXIT STATUS

=over 4

=item 0

Successful execution.

=item non-zero

An error occurred (e.g. network error, login failed, file not found).

=back

=head1 EXAMPLES

Push a package with a given priority and notification:

  ocs-pkgpush --url https://ocs.example.com/ocsreports \
    --username admin --password secret \
    --name MyPackage --description "Installs stuff" \
    --priority 1  \
    --file ./install.zip --timeout 300 \
    --notify YES \
      --notif-text "Update incoming" \
      --notif-duration 60 \
      --can-cancel NO \
      --can-report YES \
    --headless --capture-dir tmp/

=head1 SecretStorage

=head2 KeePassXC

It is possible to use KeePassXC as the backend for the SercretStorage service instead of Gnome-Keyring.
Gnome-Keyring must be partially disabled.
This is done at the user level through the following two files.

F<$HOME/.config/autostart/gnome-keyring-secrets.desktop>

 [Desktop Entry]
 Type=Application
 Name=GNOME Keyring Secrets
 Exec=/usr/bin/gnome-keyring-daemon --start --components=secrets
 Hidden=true

F<$HOME/.config/autostart/gnome-keyring-ssh.desktop>

 [Desktop Entry]
 Type=Application
 Name=GNOME Keyring SSH
 Exec=/usr/bin/gnome-keyring-daemon --start --components=ssh
 Hidden=true


=head1 SEE ALSO

L<python3(1)>, L<playwright>, L<KeePassXC>


=head1 AUTHORS

Written by Gabriel Moreau <Gabriel.Moreau(A)univ-grenoble-alpes.fr> - Grenoble - France


=head1 LICENSE AND COPYRIGHT

License GNU GPL version 2

 Copyright (C) 2025, LEGI UMR 5519 / CNRS UGA G-INP, Grenoble, France
